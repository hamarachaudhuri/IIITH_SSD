use COMPANY;

CREATE TABLE WORKS_ON_2022204001( Essn char(9) NOT NULL, Hours decimal(3,1), PRIMARY KEY(Essn));

INSERT INTO WORKS_ON_2022204001 VALUES(123456789, 40);
INSERT INTO WORKS_ON_2022204001 VALUES(666884444, 40);
INSERT INTO WORKS_ON_2022204001 VALUES(453453453, 40);
INSERT INTO WORKS_ON_2022204001 VALUES(333445555, 40);
INSERT INTO WORKS_ON_2022204001 VALUES(999887777, 40);
INSERT INTO WORKS_ON_2022204001 VALUES(987654321, 35);
INSERT INTO WORKS_ON_2022204001 VALUES(888665555, NULL);

SELECT DEPARTMENT.Mgr_ssn, DEPARTMENT.Dname, DEPARTMENT.Dnumber, EMPLOYEE.Fname, EMPLOYEE.Lname FROM DEPARTMENT, EMPLOYEE, WORKS_ON_2022204001 WHERE DEPARTMENT.Dnumber=EMPLOYEE.Dno AND EMPLOYEE.Ssn=WORKS_ON_2022204001.Essn AND WORKS_ON_2022204001.Hours<40;

----------------------------------------
ELECT Essn, SUM(Hours) AS Hour FROM WORKS_ON WHERE Hours<40 GROUP BY Essn HAVING Hour<40;